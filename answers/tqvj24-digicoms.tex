\documentclass[a4paper,12pt]{article}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{tqvj24}
\chead{}
\rhead{Digital Communications}
\begin{document}

\section*{Question 1}
Encoding $LETSSAILFORTHESPANISHMAIN$ with key $PIECESOFEIGHT$ gave \\
\begin{verbatim}
    AMXUWSWQJWXAATATCRAGMQIOU
\end{verbatim}

\section*{Question 2}
Decoding $ZVTVKGVBLNWYJVCLBOOHSSKFIGWYOEDNZ$ with key $GOLDCOINS$ gave \\
\begin{verbatim}
    THISISNOTHINGTODOWITHPIRATESATALL
\end{verbatim}

\section*{Question 3}
Using $C1$, $C2$, and $C3$, the following $M$ was found
\begin{verbatim}
    ASSOONASWESTARTEDPROGRAMMINGWEFOUNDTOOURSURPRISETHATITWASNT
    ASEASYTOGETPROGRAMSRIGHTASWEHADTHOUGHTDEBUGGINGHADTOBE
    DISCOVEREDICANREMEMBERTHEEXACTINSTANTWHENIREALIZEDTHATALARGE
    PARTOFMYLIFEFROMTHENONWASGOINGTOBESPENTINFINDINGMISTAKESINMY
    OWNPROGRAMSMAURICEWILKESDISCOVERSDEBUGGING
\end{verbatim}
Please note, line breaks were added for readability, and are \textbf{not} part of the original message

\section*{Question 4}
Calculations done by code, showing intermediate steps exactly as output from RSA.py
\subsection*{$17^{54}$ $mod$ $139$ = 125}
\begin{verbatim}
    17^1 = 17 mod 139
    17^2 = 11 mod 139
    17^4 = 121 mod 139
    17^8 = 46 mod 139
    17^16 = 31 mod 139
    17^32 = 127 mod 139

    Starting with 17^32 mod 139
    Multiplying by 17^16, to reach 17^48 mod 139
    Multiplying by 17^4, to reach 17^52 mod 139
    Multiplying by 17^2, to reach 17^54 mod 139
    Calculated 17^54 mod 139 = 125
\end{verbatim}

\subsection*{$2345^{65531}$ $mod$ $265189$ = 32548}
\begin{verbatim}
    2345^1 = 2345 mod 265189
    2345^2 = 195245 mod 265189
    2345^4 = 221653 mod 265189
    2345^8 = 77513 mod 265189
    2345^16 = 143185 mod 265189
    2345^32 = 182635 mod 265189
    2345^64 = 70805 mod 265189
    2345^128 = 215169 mod 265189
    2345^256 = 207374 mod 265189
    2345^512 = 132069 mod 265189
    2345^1024 = 209853 mod 265189
    2345^2048 = 200702 mod 265189
    2345^4096 = 144460 mod 265189
    2345^8192 = 173623 mod 265189
    2345^16384 = 116932 mod 265189
    2345^32768 = 212973 mod 265189

    Starting with 2345^32768 mod 265189
    Multiplying by 2345^16384, to reach 2345^49152 mod 265189
    Multiplying by 2345^8192, to reach 2345^57344 mod 265189
    Multiplying by 2345^4096, to reach 2345^61440 mod 265189
    Multiplying by 2345^2048, to reach 2345^63488 mod 265189
    Multiplying by 2345^1024, to reach 2345^64512 mod 265189
    Multiplying by 2345^512, to reach 2345^65024 mod 265189
    Multiplying by 2345^256, to reach 2345^65280 mod 265189
    Multiplying by 2345^128, to reach 2345^65408 mod 265189
    Multiplying by 2345^64, to reach 2345^65472 mod 265189
    Multiplying by 2345^32, to reach 2345^65504 mod 265189
    Multiplying by 2345^16, to reach 2345^65520 mod 265189
    Multiplying by 2345^8, to reach 2345^65528 mod 265189
    Multiplying by 2345^2, to reach 2345^65530 mod 265189
    Multiplying by 2345^1, to reach 2345^65531 mod 265189
    Calculated 2345^65531 mod 265189 = 32548
\end{verbatim}

\subsection*{$4733459^{65537}$ $mod$ $75968647$ = 621879}
\begin{verbatim}
    4733459^1 = 4733459 mod 75968647
    4733459^2 = 49107677 mod 75968647
    4733459^4 = 16238929 mod 75968647
    4733459^8 = 67757406 mod 75968647
    4733459^16 = 25488171 mod 75968647
    4733459^32 = 64480977 mod 75968647
    4733459^64 = 57889554 mod 75968647
    4733459^128 = 19358089 mod 75968647
    4733459^256 = 50744319 mod 75968647
    4733459^512 = 56497489 mod 75968647
    4733459^1024 = 54825938 mod 75968647
    4733459^2048 = 38930457 mod 75968647
    4733459^4096 = 49024383 mod 75968647
    4733459^8192 = 51007254 mod 75968647
    4733459^16384 = 24313 mod 75968647
    4733459^32768 = 59341440 mod 75968647
    4733459^65536 = 51988154 mod 75968647

    Starting with 4733459^65536 mod 75968647
    Multiplying by 4733459^1, to reach 4733459^65537 mod 75968647
    Calculated 4733459^65537 mod 75968647 = 621879
\end{verbatim}

\section*{Question 5}
You wish to securely send the message M=654733 to the bank
\subsection*{i) State the calculation to encrypt this message for sending to the bank}
$C = M^{e_{bank}}$ $mod$ $n_{bank}$\\\\
In this case,\\
$C = 654733^{65537}$ $mod$ $76282747$
\subsection*{ii) State the encrypted value, calculated using your code}
\begin{verbatim}
    39964485
\end{verbatim}

\section*{Question 6}
The bank sends you an encrypted message 1684446
\subsection*{i) State the calculation used in decryption}
$C^{d_{mine}} = M^{e_{mine}d_{mine}} = M$ $mod$ $n_{mine}$\\\\
In this case,\\
$C^{3497603} = M^{1676267\cdot3497603} = M$ $mod$ $9436709$
\subsection*{ii) What is the decrypted value in this case?}
\begin{verbatim}
    1101011
\end{verbatim}

\section*{Question 7}
The bank requests a signed encrypted message from you so that they can verify that you are the sender and the message is secure in transmission to them. You should encrypt the message and signature as two separate blocks. They already know your public key.
\subsection*{i) State the calculation to sign and encrypt the message 337722}
% to sign 337722 // as it uses MY d, it must have been me, and my public (which they know) and 'unsign'(using encrypt) to check it
Sign the message\\
$S = M^{d_{mine}}$ $mod$ $n_{mine}$ \\ \\
% to encrypt the signed message
Encrypt the message\\
$C_M = M^{e_{bank}}$ $mod$ $n_{bank}$\\\\
Encrypt the signature\\
$C_S = S^{e_{bank}}$ $mod$ $n_{bank}$\newpage
% bank_public_mod = 76282747
% bank_public_e = 65537
%
% my_public_mod = 9436709
% my_public_e = 1676267
% my_private_d = 3497603
\noindent In this case,\\
% to sign 337722 // as it uses MY d, it must have been me, and my public (which they know) and 'unsign'(using encrypt) to check it
$S = 337722^{3497603}$ $mod$ $9436709$ \\ \\
% to encrypt the signed message
Encrypt the message\\
$C_M = 337722^{65537}$ $mod$ $76282747$\\\\
Encrypt the signature\\
$C_S = S^{65537}$ $mod$ $76282747$

\subsection*{ii) What is the transmission made for the message 337722 when it has been signed and encrypted?}
Intermediate step, sign the message
\begin{verbatim}
    S = 7218665
\end{verbatim}
Actual transmission made
\begin{verbatim}
    C_s = 59821766
    C_m = 33191197
\end{verbatim}


\end{document}
